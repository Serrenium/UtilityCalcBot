# üí° UtilityCalc ‚Äì –ë–æ—Ç –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

Telegram-–±–æ—Ç –¥–ª—è —É—á—ë—Ç–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å—á—ë—Ç—á–∏–∫–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤–æ–¥—ã, —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –∏ –≤–æ–¥–æ–æ—Ç–≤–µ–¥–µ–Ω–∏—è –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ú–æ—Å–∫–≤—ã.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä –∏ —Å—á—ë—Ç—á–∏–∫–æ–≤  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–¥–Ω–æ—Ç–∞—Ä–∏—Ñ–Ω—ã—Ö, –¥–≤—É—Ö—Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –∏ —Ç—Ä—ë—Ö—Ç–∞—Ä–∏—Ñ–Ω—ã—Ö —ç–ª–µ–∫—Ç—Ä–æ—Å—á—ë—Ç—á–∏–∫–æ–≤  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –ú–æ—Å—ç–Ω–µ—Ä–≥–æ—Å–±—ã—Ç–∞, –ú–æ—Å–≤–æ–¥–æ–∫–∞–Ω–∞–ª–∞, –ú–û–≠–ö  
‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π SQLite-–±–∞–∑–µ (`utility_calc.db`)  
‚úÖ –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å —ç–º–æ–¥–∑–∏  
‚úÖ –ü–æ—à–∞–≥–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏ (—Å–µ—Å—Å–∏–∏) –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –≤–≤–æ–¥–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π  
‚úÖ –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ  
‚úÖ –ö–æ–º–∞–Ω–¥—ã: `/calc`, `/tariffs`, `/flats`, `/addflat`, `/addmeter`

---

## üß© –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–Ø–∑—ã–∫**: Java 17+
- **Telegram API**: [TelegramBots](https://github.com/rubenlagus/TelegramBots)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQLite (—á–µ—Ä–µ–∑ JDBC)
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª `utility_calc.db`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –û–û–ü + FSM-–ø–æ–¥–æ–±–Ω—ã–µ —Å–µ—Å—Å–∏–∏

---
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
src/
‚îú‚îÄ‚îÄ main/java/ru/
‚îÇ   ‚îú‚îÄ‚îÄ UtilityCalc.java         ‚Üê –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Db.java                  ‚Üê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
‚îÇ   ‚îî‚îÄ‚îÄ ...                      ‚Üê –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Å—É—â–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ resources/
    ‚îî‚îÄ‚îÄ application.properties   ‚Üê (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üîß –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

bash export TELEGRAM_BOT_TOKEN="123456:ABCdefghiJKLmnoPQRStuv" export TELEGRAM_BOT_USERNAME="your_bot_username"

> –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É [@BotFather](https://t.me/BotFather)

### 2. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Maven/Gradle ‚Äî —Å–æ–±–µ—Ä–∏—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ.  
–ï—Å–ª–∏ –≤—Ä—É—á–Ω—É—é:
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ JAR-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø–∞–ø–∫–µ libs/
java -cp "libs/*:." ru.UtilityCalc


> –ì–¥–µ `libs/` —Å–æ–¥–µ—Ä–∂–∏—Ç:
> - `telegrambots-x.x.x.jar`
> - `sqlite-jdbc-x.x.x.jar`
> - –¥—Ä—É–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

## üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–æ—Ç–∞

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

[ üßÆ –†–∞—Å—á—ë—Ç ] [ üí∞ –¢–∞—Ä–∏—Ñ—ã ] 
[ üè† +–ö–≤–∞—Ä—Ç–∏—Ä–∞ ] [ ‚ö° +–°—á—ë—Ç—á–∏–∫ ] 
[ üìã –ö–≤–∞—Ä—Ç–∏—Ä—ã ]


### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `/start` | –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É, —Å–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É |
| `/calc` | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—á—ë—Ç –ñ–ö–£ |
| `/tariffs` | –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã |
| `/addflat` | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É |
| `/addmeter` | –î–æ–±–∞–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ (–≤–æ–¥–∞/—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ) |
| `/flats` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã –∏ —Å—á—ë—Ç—á–∏–∫–∏ |
| `/deleteflat <id>` | –£–¥–∞–ª–∏—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É |
| `/deletemeter <id>` | –£–¥–∞–ª–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ |

---

## üóÉÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–§–∞–π–ª –±–∞–∑—ã: `utility_calc.db` (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### –¢–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `flats` | –ö–≤–∞—Ä—Ç–∏—Ä—ã: id, chat_id, name |
| `meters` | –°—á—ë—Ç—á–∏–∫–∏: —Ç–∏–ø, –ø—Ä–æ–≤–∞–π–¥–µ—Ä, –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è |
| `tariffs` | –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã –ø–æ –¥–Ω—è–º |
| `tariff_updates` | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤ |

---

## üõ†Ô∏è –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –±–∞–∑—É

### –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª:

bash sqlite3 utility_calc.db .tables SELECT * FROM flats; SELECT * FROM meters; .exit


### –ß–µ—Ä–µ–∑ GUI:
- [DB Browser for SQLite](https://sqlitebrowser.org/) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- IntelliJ IDEA ‚Üí Database Tools

---
## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
### –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (/start)

–°–æ–∑–¥–∞—ë—Ç—Å—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ ¬´–ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞¬ª
–î–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç—Ä–∏ —Å—á—ë—Ç—á–∏–∫–∞: —Ö–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞, –≥–æ—Ä—è—á–∞—è –≤–æ–¥–∞, —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ
–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Ç–∏–ø –ø–ª–∏—Ç—ã –∏ —Ç–∞—Ä–∏—Ñ —ç–ª–µ–∫—Ç—Ä–æ—Å—á—ë—Ç—á–∏–∫–∞
–ó–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è
### –†–∞—Å—á—ë—Ç (/calc)

–ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è
–í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Ö–æ–¥
–ü—Ä–∏–º–µ–Ω—è–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç
–û–±–Ω–æ–≤–ª—è–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è –≤ –±–∞–∑–µ
### –°–µ—Å—Å–∏–∏
   –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è FSM-–ø–æ–¥–æ–±–Ω—ã–µ —Å–µ—Å—Å–∏–∏:

AddMeterSession ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞
AddFlatSession ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã
CalcSession ‚Äî —Ä–∞—Å—á—ë—Ç
OnboardingSession ‚Äî –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–ë–æ—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BotFather –∫–æ–º–∞–Ω–¥—ã (/calc, /addflat) ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º
–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è / ‚Äî —É–¥–∞–ª–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤ @BotFather
–í—Å–µ —Ç–µ–∫—Å—Ç—ã –∫–Ω–æ–ø–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º
–≠–º–æ–¥–∑–∏ —É–ª—É—á—à–∞—é—Ç UX

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
üîê –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞)

/dumpdb

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Äî **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–¥–µ**
- –§–∞–π–ª `utility_calc.db` –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ Git

–î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:

```
# Ignored by default in all repositories.
*.db*
.env
```
---
üìà –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Mos.ru –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–≤–æ–¥–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π
–ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–≤–æ–¥–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π
–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel/CSV
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker

## üê≥ –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Dockerfile?

–•–æ—Ç—è –≤–∞—à –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, `Dockerfile` –ø–æ–ª–µ–∑–µ–Ω, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ:

### ‚úÖ 1. **–ó–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
- –ü—Ä–æ—Å—Ç–æ: `docker run your-bot`
- –ù–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å Java, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî –≤ –æ–¥–Ω–æ–º –æ–±—Ä–∞–∑–µ

### ‚úÖ 2. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ**
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Actions, —á—Ç–æ–±—ã –±–æ—Ç **–æ–±–Ω–æ–≤–ª—è–ª—Å—è —Å–∞–º**
- –ò–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ VPS, AWS, Render, Fly.io

### ‚úÖ 3. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–µ–¥—É**
- –ù–∏–∫–∞–∫–∏—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π Java, –±–∏–±–ª–∏–æ—Ç–µ–∫
- –†–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–µ–∑–¥–µ

### ‚úÖ 4. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ–Ω–æ—Å**
- –ü–µ—Ä–µ–Ω–µ—Å–ª–∏ `docker-compose.yml` –∏ `data/` ‚Äî –∏ –±–æ—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–ª –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ

---

## üì¶ –ü—Ä–∏–º–µ—Ä Dockerfile (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
Dockerfile FROM openjdk:17-jre-slim
WORKDIR /app
COPY libs /app/libs COPY utility_calc.db /app/utility_calc.db COPY your-bot.jar /app/app.jar
ENV TELEGRAM_BOT_TOKEN=your_token_here ENV TELEGRAM_BOT_USERNAME=your_bot_username
EXPOSE 8080
CMD ["java", "-cp", "libs/*:.", "ru.UtilityCalc"]
> –ó–∞—Ç–µ–º:
> 
> bash

docker build -t utility-calc . docker run -d utility-calc

---

## üôå –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ –ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π.

> ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, —É–¥–æ–±–Ω—ã–π.